# 🎯 Backpack代币管理工具使用指南

## 📊 **功能概述**

这个工具专门用于管理Backpack账户中的代币，提供以下功能：

1. **查询账户所有代币余额**
2. **卖出除SOL外的所有代币**
3. **获取市场信息**
4. **智能价格计算**

## 🚀 **使用方法**

### **启动工具**
```bash
python backpack_token_manager.py
```

### **菜单选项**
```
🎯 Backpack代币管理工具
============================================================
1. 查询账户所有代币余额
2. 卖出除SOL外的所有代币
3. 获取市场信息
4. 退出
============================================================
```

## 📋 **功能详解**

### **1. 查询账户所有代币余额**

#### **功能说明**
- 获取账户中所有代币的余额信息
- 显示可用数量、锁定数量、总数量
- 计算每种代币的USD价值
- 显示总资产价值

#### **输出示例**
```
🔍 查询账户所有代币余额...
💰 SOL: 1.250000 (可用: 1.200000, 锁定: 0.050000) - $125.00
💰 USDC: 500.000000 (可用: 500.000000, 锁定: 0.000000) - $500.00
💰 BTC: 0.001000 (可用: 0.001000, 锁定: 0.000000) - $45.00
💰 ETH: 0.050000 (可用: 0.050000, 锁定: 0.000000) - $100.00
📊 总资产价值: $770.00
```

### **2. 卖出除SOL外的所有代币**

#### **功能说明**
- 自动识别需要卖出的代币
- 保留SOL和USDC
- 使用市价单快速卖出
- 显示卖出结果

#### **执行流程**
```
1. 获取所有代币余额
2. 过滤出需要卖出的代币 (排除SOL和USDC)
3. 检查交易对是否存在
4. 获取当前价格
5. 使用市价单卖出
6. 显示卖出结果
```

#### **输出示例**
```
🔄 开始卖出除SOL外的所有代币...
📋 需要卖出的代币: ['BTC', 'ETH', 'DOGE', 'MATIC']

🔄 卖出 BTC: 0.001000
✅ BTC 卖出成功: 0.001000 @ 45000.0000 USDC (订单ID: 12345)

🔄 卖出 ETH: 0.050000
✅ ETH 卖出成功: 0.050000 @ 2000.0000 USDC (订单ID: 12346)

🔄 卖出 DOGE: 1000.000000
✅ DOGE 卖出成功: 1000.000000 @ 0.0800 USDC (订单ID: 12347)

🔄 卖出 MATIC: 50.000000
✅ MATIC 卖出成功: 50.000000 @ 0.8000 USDC (订单ID: 12348)

✅ 卖出完成: 4/4 个代币成功
   BTC: ✅ 成功
   ETH: ✅ 成功
   DOGE: ✅ 成功
   MATIC: ✅ 成功
```

### **3. 获取市场信息**

#### **功能说明**
- 获取所有可用的交易对
- 显示交易对状态
- 帮助了解市场情况

#### **输出示例**
```
📊 获取市场信息...
📊 获取到 111 个交易对

✅ 获取到 111 个交易对
   1. SOL_USDC - active
   2. BTC_USDC - active
   3. ETH_USDC - active
   4. DOGE_USDC - active
   5. MATIC_USDC - active
   6. AVAX_USDC - active
   7. LINK_USDC - active
   8. UNI_USDC - active
   9. ATOM_USDC - active
   10. DOT_USDC - active
   ... 还有 101 个交易对
```

## ⚙️ **配置说明**

### **环境变量配置**
```env
# config.env文件
BACKPACK_API_KEY=your_api_key_here
BACKPACK_PRIVATE_KEY=your_private_key_here
```

### **配置参数**
```python
@dataclass
class TokenManagerConfig:
    api_key: str = os.getenv('BACKPACK_API_KEY', '')
    private_key: str = os.getenv('BACKPACK_PRIVATE_KEY', '')
    base_url: str = 'https://api.backpack.exchange'
    min_sell_amount: float = 0.001  # 最小卖出数量
    max_retries: int = 3  # 最大重试次数
```

## 🛡️ **安全特性**

### **风险控制**
- ✅ 保留SOL和USDC不被卖出
- ✅ 设置最小卖出数量阈值
- ✅ 确认机制防止误操作
- ✅ 详细的日志记录

### **错误处理**
- ✅ API请求重试机制
- ✅ 交易对存在性检查
- ✅ 价格获取失败处理
- ✅ 异常情况记录

## 📊 **使用场景**

### **场景1：清理账户**
```
目的: 将账户中的零散代币统一转换为USDC
操作: 选择选项2，卖出除SOL外的所有代币
结果: 账户中只保留SOL和USDC
```

### **场景2：查看资产**
```
目的: 了解账户中的代币分布和总价值
操作: 选择选项1，查询所有代币余额
结果: 获得详细的资产报告
```

### **场景3：市场调研**
```
目的: 了解可用的交易对
操作: 选择选项3，获取市场信息
结果: 查看所有可用的交易对
```

## ⚠️ **注意事项**

### **重要提醒**
1. **确认操作**: 卖出操作需要确认，避免误操作
2. **网络稳定**: 确保网络连接稳定，避免交易失败
3. **API限制**: 注意API调用频率限制
4. **价格波动**: 市价单可能受到价格波动影响

### **支持条件**
- ✅ 需要有效的API Key和Private Key
- ✅ 账户中需要有可卖出的代币
- ✅ 交易对必须存在于Backpack交易所
- ✅ 代币数量必须大于最小卖出阈值

## 🎯 **总结**

这个代币管理工具提供了：

1. **完整的代币余额查询**
2. **智能的代币卖出功能**
3. **市场信息获取**
4. **安全的操作确认**
5. **详细的日志记录**

通过这个工具，您可以轻松管理Backpack账户中的代币，实现资产的统一管理和优化配置！🎯
